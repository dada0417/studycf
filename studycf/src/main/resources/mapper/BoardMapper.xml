<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="studycf.mapper.BoardMapper">
	<resultMap type="Board" 						id="boardResultMap">
		<id column="board_cd"					property="boardCd"/>
		<result column="board_ctg_cd"				property="boardCtgCd"/>
		<result column="user_id"					property="userId"/>
		<result column="board_title"			property="boardTitle"/>
		<result column="board_content"			property="boardContent"/>
		<result column="board_date"			property="boardDate"/>
		<result column="board_views"			property="boardViews"/>
		<result column="board_comment_num"	property="boardCommentNum"/>
		<association property="boardCtg" 	javaType="BoardCtg">
			<id 	 column="board_ctg_cd" 	property="boardCtgCd"/>
			<result  column="board_ctg_nm" 	property="boardCtgNm"/>
		</association>
		<collection property="tFile" ofType="TFile">
			<id		column="file_cd"				property="fileCd"/>
			<result	column="original_file_nm"		property="originalFileName"/>
			<result	column="stored_file_path"		property="storedFilePath"/>
			<result	column="file_size"				property="fileSize"/>
			<result column="re_file_name"			property="reFileName"/>
			<result	column="uploader_id"			property="uploaderId"/>
			<result	column="upload_date"			property="uploadDate"/>
			<result	column="updator_id"				property="updatorId"/>
			<result	column="updated_date"			property="updatedDate"/>
			<result	column="represent_img"		property="representImg"/>
		</collection>
	</resultMap>

	
	
	<select id="getBoardList" parameterType="map" resultType="map" resultMap="boardResultMap">
		SELECT
			b.board_cd					
			,b.board_ctg_cd		
			,bc.board_ctg_nm
			,b.user_id						
			,b.board_title				
			,b.board_content			
			,b.board_date				
			,b.board_views				
			,b.board_comment_num	
		FROM
			board AS b
			inner join
			board_ctg as bc
			on
			b.board_ctg_cd = bc.board_ctg_cd
		LIMIT #{startRow}, #{rowPerPage};
	</select>
	
	<!-- 게시글 총 튜플 수 -->
	<select id="getBoardCount" resultType="int">
		SELECT
			COUNT(*)
		FROM
			board;
	</select>
	
	
	<!-- 게시글 작성 -->
	<insert id="addBoard" parameterType="Board">
		<selectKey resultType="String" keyProperty="boardCd" order="BEFORE">
			SELECT sf_new_board_cd()
		</selectKey>
		INSERT INTO board
			(board_cd
			, board_ctg_cd
			, user_id
			, board_title
			, board_content
			, board_date
			, board_views
			, board_comment_num)
		VALUES(
			sf_new_board_cd()
			, #{boardCtgCd}
			, #{userId}
			, #{boardTitle}
			, #{boardContent}
			, NOW()
			, #{boardViews}
			, 0);
	</insert>
	
	
	<!-- 게시글 카테고리 조회 -->
	<select id="getBoardCtg" parameterType="String" resultMap="boardResultMap">
		SELECT 
			bc.board_ctg_cd
			, bc.board_ctg_nm
		FROM 
			board_ctg AS bc;
	</select>
	
	


	

	
	

	
</mapper>